# Migration `20201129222748`

This migration has been generated by George Munyoro at 11/30/2020, 12:27:48 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Board" DROP CONSTRAINT "Board_id_fkey"

ALTER TABLE "Column" DROP CONSTRAINT "Column_id_fkey"

ALTER TABLE "Column" DROP CONSTRAINT "Column_id_fkey1"

ALTER TABLE "Comment" DROP CONSTRAINT "Comment_id_fkey1"

ALTER TABLE "Comment" DROP CONSTRAINT "Comment_id_fkey2"

ALTER TABLE "Comment" DROP CONSTRAINT "Comment_id_fkey"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_id_fkey"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_id_fkey1"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_id_fkey3"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_id_fkey2"

ALTER TABLE "Project" DROP CONSTRAINT "Project_id_fkey"

ALTER TABLE "Board" ADD COLUMN     "projectId" TEXT NOT NULL

ALTER TABLE "Column" ADD COLUMN     "projectId" TEXT NOT NULL,
ADD COLUMN     "boardId" TEXT NOT NULL

ALTER TABLE "Comment" ADD COLUMN     "authorId" TEXT NOT NULL,
ADD COLUMN     "projectId" TEXT NOT NULL,
ADD COLUMN     "issueId" TEXT NOT NULL

ALTER TABLE "Issue" ADD COLUMN     "authorId" TEXT NOT NULL,
ADD COLUMN     "projectId" TEXT NOT NULL,
ADD COLUMN     "boardId" TEXT NOT NULL,
ADD COLUMN     "columnId" TEXT NOT NULL

ALTER TABLE "Project" ADD COLUMN     "ownerId" TEXT NOT NULL

ALTER TABLE "Board" ADD FOREIGN KEY("projectId")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Column" ADD FOREIGN KEY("projectId")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Column" ADD FOREIGN KEY("boardId")REFERENCES "Board"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Comment" ADD FOREIGN KEY("authorId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Comment" ADD FOREIGN KEY("projectId")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Comment" ADD FOREIGN KEY("issueId")REFERENCES "Issue"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("authorId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("projectId")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("boardId")REFERENCES "Board"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("columnId")REFERENCES "Column"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Project" ADD FOREIGN KEY("ownerId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201129221322..20201129222748
--- datamodel.dml
+++ datamodel.dml
@@ -2,64 +2,86 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id              String    @id @default(uuid())
-  email           String    @unique
-  firstname       String
-  lastname        String
-  password        String
-  createdAt       DateTime  @default(now())
+  id        String    @id @default(uuid())
+  email     String    @unique
+  firstname String
+  lastname  String
+  password  String
+  createdAt DateTime  @default(now())
+  Project   Project[]
+  Issue     Issue[]
+  Comment   Comment[]
 }
 model Project {
-  id              String    @id @default(uuid())
-  owner           User      @relation(fields: [id])
-  createdAt       DateTime  @default(now())
-  updatedAt       DateTime  @updatedAt
+  id        String    @id @default(uuid())
+  owner     User      @relation(fields: [ownerId], references: [id])
+  ownerId   String
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  Board     Board[]
+  Column    Column[]
+  Issue     Issue[]
+  Comment   Comment[]
 }
 model Board {
-  id              String    @id @default(uuid())
-  project         Project   @relation(fields: [id])
-  createdAt       DateTime  @default(now())
-  updatedAt       DateTime  @updatedAt
+  id        String   @id @default(uuid())
+  project   Project  @relation(fields: [projectId], references: [id])
+  projectId String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  Column    Column[]
+  Issue     Issue[]
 }
 model Column {
-  id              String    @id @default(uuid())
-  position        Int
-  project         Project   @relation(fields: [id])
-  board           Board     @relation(fields: [id])
-  createdAt       DateTime  @default(now())
-  updatedAt       DateTime  @updatedAt
+  id        String   @id @default(uuid())
+  position  Int
+  project   Project  @relation(fields: [projectId], references: [id])
+  projectId String
+  board     Board    @relation(fields: [boardId], references: [id])
+  boardId   String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  Issue     Issue[]
 }
 model Issue {
-  id              String    @id @default(uuid())
-  author          User      @relation(fields: [id])
-  title           String
-  description     String
-  project         Project   @relation(fields: [id])
-  board           Board     @relation(fields: [id])
-  column          Column    @relation(fields: [id])
-  createdAt       DateTime  @default(now())
-  updatedAt       DateTime  @updatedAt
+  id          String    @id @default(uuid())
+  author      User      @relation(fields: [authorId], references: [id])
+  authorId    String
+  title       String
+  description String
+  project     Project   @relation(fields: [projectId], references: [id])
+  projectId   String
+  board       Board     @relation(fields: [boardId], references: [id])
+  boardId     String
+  column      Column    @relation(fields: [columnId], references: [id])
+  columnId    String
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
+  Comment     Comment[]
 }
 model Comment {
-  id              String    @id @default(uuid())
-  author          User      @relation(fields: [id])
-  contents        String
-  project         Project   @relation(fields: [id])
-  issue           Issue     @relation(fields: [id])
-  createdAt       DateTime  @default(now())
-  updatedAt       DateTime  @updatedAt
+  id        String   @id @default(uuid())
+  author    User     @relation(fields: [authorId], references: [id])
+  authorId  String
+  contents  String
+  project   Project  @relation(fields: [projectId], references: [id])
+  projectId String
+  issue     Issue    @relation(fields: [issueId], references: [id])
+  issueId   String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
 }
```


