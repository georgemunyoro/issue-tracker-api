# Migration `20201129221322`

This migration has been generated by George Munyoro at 11/30/2020, 12:13:22 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Board" DROP CONSTRAINT "Board_projectId_fkey"

ALTER TABLE "Column" DROP CONSTRAINT "Column_boardId_fkey"

ALTER TABLE "Column" DROP CONSTRAINT "Column_projectId_fkey"

ALTER TABLE "Comment" DROP CONSTRAINT "Comment_issueId_fkey"

ALTER TABLE "Comment" DROP CONSTRAINT "Comment_projectId_fkey"

ALTER TABLE "Comment" DROP CONSTRAINT "Comment_userId_fkey"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_boardId_fkey"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_columnId_fkey"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_projectId_fkey"

ALTER TABLE "Issue" DROP CONSTRAINT "Issue_userId_fkey"

ALTER TABLE "Project" DROP CONSTRAINT "Project_userId_fkey"

ALTER TABLE "Board" DROP COLUMN "projectId"

ALTER TABLE "Column" DROP COLUMN "projectId",
DROP COLUMN "boardId"

ALTER TABLE "Comment" DROP COLUMN "userId",
DROP COLUMN "projectId",
DROP COLUMN "issueId"

ALTER TABLE "Issue" DROP COLUMN "userId",
DROP COLUMN "projectId",
DROP COLUMN "boardId",
DROP COLUMN "columnId"

ALTER TABLE "Project" DROP COLUMN "userId"

ALTER TABLE "User" ALTER COLUMN "firstname" SET NOT NULL

ALTER TABLE "Board" ADD FOREIGN KEY("id")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Column" ADD FOREIGN KEY("id")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Column" ADD FOREIGN KEY("id")REFERENCES "Board"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Comment" ADD FOREIGN KEY("id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Comment" ADD FOREIGN KEY("id")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Comment" ADD FOREIGN KEY("id")REFERENCES "Issue"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("id")REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("id")REFERENCES "Board"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Issue" ADD FOREIGN KEY("id")REFERENCES "Column"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Project" ADD FOREIGN KEY("id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201129195907..20201129221322
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -12,54 +12,54 @@
 model User {
   id              String    @id @default(uuid())
   email           String    @unique
-  firstname       String?
+  firstname       String
   lastname        String
   password        String
   createdAt       DateTime  @default(now())
 }
 model Project {
   id              String    @id @default(uuid())
-  owner           User
+  owner           User      @relation(fields: [id])
   createdAt       DateTime  @default(now())
   updatedAt       DateTime  @updatedAt
 }
 model Board {
   id              String    @id @default(uuid())
-  project         Project
+  project         Project   @relation(fields: [id])
   createdAt       DateTime  @default(now())
   updatedAt       DateTime  @updatedAt
 }
 model Column {
   id              String    @id @default(uuid())
   position        Int
-  project         Project
-  board           Board
+  project         Project   @relation(fields: [id])
+  board           Board     @relation(fields: [id])
   createdAt       DateTime  @default(now())
   updatedAt       DateTime  @updatedAt
 }
 model Issue {
   id              String    @id @default(uuid())
-  author          User
+  author          User      @relation(fields: [id])
   title           String
   description     String
-  project         Project
-  board           Board
-  column          Column
+  project         Project   @relation(fields: [id])
+  board           Board     @relation(fields: [id])
+  column          Column    @relation(fields: [id])
   createdAt       DateTime  @default(now())
   updatedAt       DateTime  @updatedAt
 }
 model Comment {
   id              String    @id @default(uuid())
-  author          User
+  author          User      @relation(fields: [id])
   contents        String
-  project         Project
-  issue           Issue
+  project         Project   @relation(fields: [id])
+  issue           Issue     @relation(fields: [id])
   createdAt       DateTime  @default(now())
   updatedAt       DateTime  @updatedAt
 }
```


